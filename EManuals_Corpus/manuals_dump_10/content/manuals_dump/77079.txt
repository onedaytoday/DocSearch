Touchmonitor LCD Touchmonitor with (USB) 1525L Revision P/N TouchSystems, Inc. 1-800-ELOTOUCH www.elotouch.com
Copyright Inc. Rights of this reproduced, transmitted, transcribed, or translated or or including, to, or otherwise without written of TouchSystems. The information this to without or with to the hereof, and specifically of merchantability or the right to this and to from to the hereof without obligation of to of such revisions or SecureTouch, AccuTouch, Entuitive, and MonitorMouse of Inc. Other or of their respective other than its own. Acknowledgments
About the Product Congratulations purchase of touchmonitor. touchmonitor the performance of with the LCD This of features flow of information user and touchmonitor. Follow and as recommended this to the of information touchmonitor LCD Touchmonitor XGA TFT with the following features: Direct RGB input XGA/ SVGA/ VGA/ VESA/ refresh C C HAPTER NTRODUCTION
o o o o High OSD four English, Spanish, and or USB interface (USB and XP.) Patented of VESA DDC 1/2B VESA DPMS with of VESA physical mounting interface OSD and Product Specifications to C.
Touchmonitor This chapter to LCD touchmonitor and to software. that the following items and LCD CD Software CD, and software CD C HAPTER NSTALLATION AND ETUP touchscreen USB touchscreen C OR
Product o o o o Unit Rear LCD
Touch Interface CAUTION connecting the to touchmonitor and PC, that the and the touchmonitor turned off. o o o o OTE interface to the factory. touchmonitor with of the following touchscreen (RS-232) or USB and XP only.) To this please to the following and procedures: The following connecting touchmonitor using back Touchscreen touchscreen
STEP the The routed through the back of the To the back cover, the top of the and other the from the and the cover off. The located the of touchmonitor.
o o o o STEP 2-Connecting the the and back to the the (the to the PC. the other of the to the touchmonitor routing the through the the the to touchmonitor and PC turning the screws the clockwise. the the
STEP 3-Connecting the Touchscreen the of the (RS-232) to the the back of PC. the of the to the touchscreen touchmonitor. the to touchmonitor and PC turning the screws the the through the Touchscreen Touchscreen
o o o o STEP 4-Connecting the OTE If to the to To the built to the the to the the back of touchmonitor. the other of the to the PC.
STEP 5-Connecting the where the or the of the to the the touchmonitor. Route the through the OTE To of from the the touchmonitors protector, and then the to grounded AC STEP the Cover the connected: the back cover. PC then touchmonitor. the should appear. AC
CAUTION the to touchmonitor and PC, that the and the touchmonitor turned off. o o o o USB OTE USB PC or XP. The following touchmonitor USB back cover USB USB touchscreen
STEP the Cover The routed through the back of the To the back cover, the top of the and other the from the and the cover off. The located the of touchmonitor.
o o o o STEP 2-Connecting the the and back to the the (the to the PC. the other of the to the touchmonitor routing the through the the the to touchmonitor and PC turning the screws the clockwise. the the
STEP 3-Connecting the USB Touchscreen the USB touchscreen to the USB touchscreen the touchmonitor. the other of the USB touchscreen to PC. The touchscreen should the touchmonitor and PC. Route the through the USB touchscreen USB touchscreen
o o o o STEP 4-Connecting the OTE If to the to To the built to the Both of the of the to the the of touchmonitor. the other of the to the PC.
STEP 5-Connecting the where the or the of the the the touchmonitor. Route the through the OTE To of from the the touchmonitors protector, and then the to grounded AC STEP the the connected: the back cover PC then touchmonitor. the should appear.
the LCD VESA Mount Touchmonitor o o o o To the LCD with the of graphic to than or to and the of the with the LCD to information about Compatible touchmonitor C. touchmonitor conforms to the VESA Physical Mounting Interface (FPMPMI) which physical mounting interface monitors, and mounting such as and The VESA mounting interface located the back of touchmonitor and shipped to the base. VESA mounting interface OTE The displays the VESA mounting interface the of the mounting cover and base. threaded
Mounting the Accessing the VESA Mounting Interface If to to mount or follow the below to the VESA mounting interface. OTE You screwdriver the following the back cover of the the the At the top of the mounting screw there With screwdriver, the mounting screw cover. The cover tight the mounting screw cover, four screws. the screws to mount to the The following VESA mounting with touchmonitor: www.ergotron.com GCX You mount touchmonitor the the of the These easy mounting. You touchmonitor to or other Please to C location and of the mounting Office Products www.innov-office-prod.com MRI www.mediarecovery.com
the Software o o o o software that allows touchmonitor to with located the CD-ROM the following operating XP NT Additional and information other operating (including MS DOS, OS/2, and the www.elotouch.com. touchmonitor plug-and-play Information the of touchmonitor to when If touchmonitor, follow the instructions the to plug-and-play to the following section instructions.
the Touch XP, and NT OTE and NT rights to the the CD-ROM CD-ROM If the CD-ROM active, the the CD and the Follow the the to the of If the active: Click Click the to the the CD-ROM. Click then OK to Follow the the to the of 1.To and XP, the within the
o o o o the Touch MS-DOS and You DOS (MOUSE.COM) to with touchmonitor DOS. To and MS-DOS from follow the below: the CD-ROM CD-ROM From DOS, type to to the directory the CD-ROM CD-ROM mapped to and to the installation. the touchscreen. You already completed and proceeding. to Chapter of the DOS and as additional information. To the INSTALL INSTALL the DOS the directory containing the INSTALL to the software to Then choose from the INSTALL the to or its INSTALL as necessary, and they If software, to specify the containing the earlier and overwrite the of from each of the to "Differences from Previous the process. INSTALL AUTOEXEC.BAT with the select. INSTALL of AUTOEXEC.BAT AUTOEXEC.OLD. If already commands AUTOEXEC.BAT they INSTALL finished, GO.BAT the subdirectory specified. GO the touchscreen the ELOCALIB, and instructions. If the touchscreen within with the Touchscreen
the USB Touch the USB Touch XP, and the CD-ROM CD-ROM If or the New Choose Next Select Search the (Recommended) and choose Next of search locations displayed, Specify location and to the directory the CD-ROM. Choose Next Once the USB touchscreen detected, choose Next You copied. CD prompted. Choose If or the New OTE rights to the the CD-ROM CD-ROM If the CD-ROM active, the the CD and the Follow the the to the of If the active: Click Click the to the the CD-ROM. Click then OK to Follow the the to the of
o o o o
About Touchmonitor the On-Screen (OSD) touchmonitor and to touchmonitor to the of the performance, touchmonitor should operating that the to choose other performance. further information, please to A. to the This from to choices or touchmonitor off and If there touchmonitor to the factory specifications. using the on-screen (OSD) items selected the buttons the OTE OSD C C HAPTER PERATION
o o o o MENU the OSD SELECT item Function Shortcut to Increase of items With OSD options Shortcut to Decrease of the items With OSD options Volume/Down Shortcut to Select- To the items from the OSD To the function to Switch Switches the on/off to touchmonitor. Press the and the to the MUTE OSD Press the and buttons the and seconds to the OSD OSD Press the and the and seconds to the function. OSD
OSD Function Phase the the Brightness Clock the brightness the OSD H-Position the the of the OSD H-Position OSD the the of the OSD factory of the C1/C2/USER (Color) these icons, of the (9300K or 6500K). Confirm choice the SELECT If to the individually, USER and the OSD SELECT the OSD to the R, and (red, and foreground). To first the SELECT then choose the with the OSD To the the SELECT If to further choose the to to the OSD CONTRAST OSD seconds) the OSD closing action Automatically selects the optional (brightness, phase, OSD Selection of the OSD English, Spanish, Information the graphics
o o o o
to Common appears that the I/O and properly connected as Chapter the of the crooked or of to the of higher than that of the LCD the of to than or to information If with touchmonitor, to the following If the please or service C HAPTER ROUBLESHOOTING supply trying outlet or another the the properly connected and that the that and properly C
PHASE to and the of the refresh of graphic to with the LCD and CLOCK to the VGA (or connected. and the of the refresh of graphic to with the LCD Touch securely attached both o o o o
The of the which the LCD to the LCD touchmonitor, the the XGA-15 inch when their You the of increase LCD (VGA) input to (SVGA) input to (XGA) Native The of LCD the of the LCD the of vertically the LCD. LCD the following C HAPTER ATIVE ESOLUTION VGA SVGA XGA SXGA UXGA A-31
A-32 o o o o SVGA LCD vertically. the terms. XGA input of vertically. the input the input match the of the there to of of input to LCD the and of the input and of the LCD. the when the input than the of the LCD, the the and the LCD The LCD the and LCD algorithms its The of the algorithms the of of to LCD artifacts the LCD such as characters.
This information that the and of touchmonitor. and touchmonitor, through this Chapter and (Operation). To reduce the of shock, follow and the touchmonitor Turn off the cleaning touchmonitor with grounding cord. The only grounded to the outlet that this cord. only the that with Touchmonitor. of unauthorized warranty. The located the and top of the touchmonitor or the It that touchmonitor or touchmonitor. If touchmonitor becomes to it yourself. C HAPTER OUCHMONITOR AFETY B-33
and of Touchmonitor B-34 o o o o The following touchmonitor functioning the To of shock, the supply or The serviceable. to the from the outlet cleaning. or or thinner or cleaners or To the cloth lightly with touchmonitor. If service the with cloth or that scratch the To the or cleaner. the the and the touchscreen. apply the directly the touchscreen
Compatible H. V. IBM VESA VGA IBM VESA VGA IBM VESA VGA IBM VESA VGA IBM VESA VGA IBM VESA VGA VESA SVGA VESA SVGA VESA SVGA VESA SVGA VESA XGA VESA XGA VESA XGA Apple LC Apple II Apple Apple NEC FC-98 NEC FC-98 NEC FC-98 touchmonitor with the following C HAPTER ECHNICAL PECIFICATIONS C C-35
Touchmonitor Specifications C.1 LCD Touchmonitor (ET15-XXWA-1) Specifications C-36 o o o o Active thin (TFT), 15-inch Format 0.125-inch and Touchscreen AccuTouch, or AccuTouch with dithering Colors typical AccuTouch: typical Brightness hours Back-light typical or or typical Ratio (tf) Humidity Mechanical ohms, EMC UL, and TUV-GS, FCC-B, CE, C-Tick and VCCI 0C to 40C -25C to +60C AT IT and AccuTouch VGA/SVGA/XGA VAC,
Table C.2 Touchmonitor Specifications Mechanical of than to than More than touchpoints/in Touch Activation Typically than ounces Force that of rating of Expected known wear-out as there layers, coatings, Performance or operationally tested to than touches location without using to Unit sealed to splashed and Light ASTM D1003) USAF Chart, 30X with located from of chart. Clear with noticeable ASTM D2457 using Curved: or C-37
C-38 o o o o Chemical The active of the touchscreen to chemicals that such Ammonia-based cleaners Protection EN
Table C.3 AccuTouch Touchmonitor Specifications Mechanical Construction with hard-surface coating with clear or finish. coating. with resistive coating. Top and of than This to than than touchpoints/in Touch Activation Force Typically than ounces (ASTM D1044), CS-10F 3H. Expected AccuTouch operationally tested to than Performance touches location without using to Light Typically light ASTM D1003) USAF Chart, with located approximately from of chart. ASTM D1003) than ASTM D2457) tested hard-coated front C-39
LCD Touchmonitor (ET15-XXWA-1) C-40 o o o o
C-41
C-42 o o o o
I. Information: A) with to the and indicated the to than those specified operation, to the or fire the B) There serviceable this There this which Service should only service technician. C) This with which ground to grounded the with other than the type. to to outlet as this the of the grounding wire. The the of the ground as of the or shock that serious or death. or the there about the to connecting the to II. and Immunity Information A) Notice to the United States: This tested and found to comply with the Class to of FCC These to reasonable protection interference installation. This and and and with the instructions, interference to B) Notice to This with the Class from as established the Regulations of C) Notice to the Union: only the and interconnecting cabling with the of and cabling or CE or immunity as the following C HAPTER EGULATORY NFORMATION
o o o o This Information (ITE) to CE the which that the tested to the following Directives and This tested to the the CE as EMC Directive 89/336/EEC indicated EN Class and the Directive 73/23/EEC as indicated EN D) Information to Users: This and ate If and to this the interference with and There however, that interference to factors. to and immunity the the following: If this appears to interference with or reception, or other If or or technician. the I/O to this with To the cord. The that or to the the the authority to the as turning the off and If that this causing the interference, to the interference using or of the following the from the affected receiver. Reposition (turn) the with to the affected receiver. the affected receivers the AC the and the branch Disconnect and I/O that the (Unterminated I/O of high RF the grounded AC (Removing or the ground increase RF and shock to the
N10051
o o o o
as otherwise stated or acknowledgment to warrants to that the Product free of and workmanship. The warranty the touchmonitors and of the warranty the of and from to the as Products or writing promptly (and than thirty discovery) of the of Product to to the warranty forth reasonable such the associated with such and to the opportunity to inspect such Products as The the Warranty such otherwise directed writing the Within thirty such the Product its or functional and to and Within reasonable of the Product and that the Product to the warranty forth such by, options, or the Product or the Product. or and the of the Product with to bear the of or and the Product. incurred Product found to or of Products option, or If to or Product to to the warranty forth then option, to or to account the purchase of the Product straight-line stated Warranty C HAPTER ARRANTY
o o o o THESE REMEDIES SHALL BE THE BUYERS EXCLUSIVE REMEDIES FOR BREACH OF WARRANTY. EXCEPT FOR THE EXPRESS WARRANTY SET FORTH ABOVE, SELLER GRANTS NO OTHER WARRANTIES, EXPRESS OR IMPLIED BY STATUTE OR OTHERWISE, REGARDING THE PRODUCTS, THEIR FITNESS FOR ANY PURPOSE, THEIR QUALITY, THEIR MERCHANTABILITY, THEIR NONINFRINGEMENT, OR OTHERWISE. NO EMPLOYEE OF SELLER OR ANY OTHER PARTY IS AUTHORIZED TO MAKE ANY WARRANTY FOR THE GOODS OTHER THAN THE WARRANTY SET FORTH HEREIN. SELLERS LIABILITY UNDER THE WARRANTY SHALL BE LIMITED TO REFUND OF THE PURCHASE PRICE OF THE PRODUCT. IN NO EVENT SHALL SELLER BE LIABLE FOR THE COST OF PROCUREMENT OR INSTALLATION OF SUBSTITUTE GOODS BY BUYER OR FOR ANY SPECIAL, CONSEQUENTIAL, INDIRECT, OR INCIDENTAL DAMAGES. the and to and from relating to assessing the of the Products and of or and the of of the Products with and and responsibility warranty and other relating to or from products, which include or incorporate Products or or and and the Products or authorized and from or (including reasonable attorneys attributable to products or or warranties concerning
USB (UNIVERSAL SERIAL BUS) SWIPE READER TECHNICAL REFERENCE MANUAL AUGUST South Carson, CA FAX: Technical
Information this to without of this or or or mechanical, without the written of Inc. of Inc. USB (Universal Specification Copyright Corporation, Corporation, Microsoft Corporation, NEC Corporation. REVISIONS Notes Copyright MAG-TEK, Inc. Printed the United States of America Initial Release Section On Tracks and than of and that From Card This this Agency Corrected Class CE. Section Changed from to
Warranty Inc. warrants this IN ITS ENTIRETY, to of from the of purchase from Should this to this warranty its option, or this charge as forth below. and products furnished and reconditioned or and products become the property of This warranty include service to to the from or of the Warranty service obtained the the warranty to S. Carson, CA If this to the or the of or to charges to the warranty service location and to the or ALL EXPRESS AND IMPLIED WARRANTIES FOR THIS PRODUCT, INCLUDING THE WARRANTIES OF MERCHANTABILITY AND FITNESS FOR PARTICULAR PURPOSE, ARE LIMITED IN DURATION TO PERIOD OF ONE YEAR FROM THE DATE OF PURCHASE, AND NO WARRANTIES, WHETHER EXPRESS OR IMPLIED, WILL APPLY AFTER THIS PERIOD, EXCEPT AS PROVIDED IN THE PRECEDING SENTENCE. EACH PURCHASER UNDERSTANDS THAT THE MAG-TEK PRODUCT IS OFFERED AS IS. IF THIS PRODUCT IS NOT IN GOOD WORKING ORDER AS WARRANTED ABOVE, YOUR SOLE REMEDY SHALL BE REPAIR OR REPLACEMENT AS PROVIDED ABOVE. IN NO EVENT WILL MAG-TEK BE LIABLE TO YOU FOR ANY DAMAGES, INCLUDING ANY LOST PROFITS, LOST SAVINGS OR OTHER INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OF OR INABILITY TO USE SUCH PRODUCT, EVEN IF MAG-TEK HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, OR FOR ANY CLAIM BY ANY OTHER PARTY. THIS WARRANTY GIVES YOU SPECIFIC LEGAL RIGHTS, AND YOU MAY ALSO HAVE OTHER RIGHTS WHICH VARY FROM STATE TO STATE.
FCC WARNING STATEMENT This tested and found to comply with the Class to of FCC These to reasonable protection interference when the operated This and and, and with the instruction interference to there that interference FCC COMPLIANCE STATEMENT This with of the FCC of this to the following This interference; and this interference received, including interference that operation. CANADIAN DOC STATEMENT This the Class the Interference Regulations of the of CE STANDARDS Testing to CE laboratory. The found to Class B. UL/CSA This and
SECTION FEATURES AND SPECIFICATIONS The USB which conforms to ISO The with the PC of or with USB interface. and facing the LED through the or backward. LED (Light the the with of the operations. The conforms to the USB Interface (HID) Class This allows the of to easily to the using API that to the through the HID that with HID readers, this It HID that established the and the without interference such as from other HID with its written that the the API. FEATURES of the as follows: through the USB supply Compatible with PC or or with USB interface reading Reads that ANSI/ISO/CDL/AAMVA and others such as ISO track or Reads to three of LED Compatible with USB Revision Compatible with HID Can HID third required. USB USB EEPROM memory property foot USB
USB CONFIGURATIONS The as follows: ACCESSORIES The as follows: REFERENCE DOCUMENTS Axelson, USB Everything You to Custom USB Peripherals Research, WI USB Interface (HID) Class USB (Universal Specification, Copyright Corporation, Corporation, Microsoft Corporation, NEC Corporation. USB Inc SPECIFICATIONS Table the specifications the shows the the Other Tracks P/N TK Pearl White P/N TK Black P/N TK Pearl White P/N TK Black P/N TK Pearl White P/N TK Black USB MSR with Source USB MSR with Source (WEB)
Section and Specifications Table Specifications Reference ISO and ISO 7811/CDL/ AAMVA* 5V From USB Recording coherent phase (F2F) Format ASCII Card to IPS MTBF hours. Head: Normal Connector USB o to o o C to o C) o to o o C to o C) to to ISO (International CDL (California and AAMVA (American Association of MECHANICAL (STANDARD PRODUCT) ELECTRICAL ENVIRONMENTAL
USB
SECTION INSTALLATION This section the the and and the physical mounting of the USB CONNECTION the USB to USB the host. The LED and the shown and Connector and the shown the Table Connector CC White Ground Black LED
USB WINDOWS PLUG AND PLAY SETUP On with the operating the first the USB which through the of the this completed once, this as as the the USB The that this the HID and of the operating the follow the instructions to the the its without Other to know the location of the If the locations, the CD that to PC and to the directory of the CD. should the there. MOUNTING The mounted with screws or as below. The should mounted such that the (mounting to the This the mounting of the to The mounted three screws through the attached to the of the and the the top of the screws through the attached to the of the and the the and the through the attaching the to the with and the the top of the The mounting pitch; The of the screws the mounting thickness and the thickness of washers used). The mounting shown the of mounting required.
Section Mounting the with least inches clearance to the the with the LED facing the of If to used, clean the that the mounted with isopropyl the protective cover the and the and firmly. Mount the
USB
SECTION OPERATION This section the LED and Card Read. LED INDICATOR The LED off, red, or the the LED off. the first the LED red. as the the to the Once the the LED indicating that the ready swiped, the LED off temporarily the completed. If there the then the LED If there the the LED approximately seconds to that occurred and then the the the LED off. Once the the of the LED to the to CARD READ through the when the LED The the front (the with the LED) and If there the the to the and then the to the USB HID input the to the host, the ready to the
USB
SECTION USB COMMUNICATIONS This conforms to the USB This conforms with the Interface (HID) The to the as HID The about the and commands HID reports follow this section. The of the operating and with USB HID that to this easily developed. These to the API that to the the USB HID These easily using such as Microsofts or C++. and its written that with this This to the and as other More about the follow this It recommended that software become with the HID the USB to with this This that the with these specifications. These specifications free from This USB This of These EEPROM memory. These the factory or the The that to the of to This property to or the The More about these found this the section. The when directed to the host. The from when directed to the host. The This from the USB Its ID and its ID HID USAGES HID reports. of The of the reports and the to the The the only once, right the The the and as the four The the and the least IDs. that related or they such as and found the HID and free the this The this the
USB following The These the HID ID (Hex) REPORT DESCRIPTOR The HID as follows: Item Decoding Collection Track Track Track Track Track 2A Track Track Track Track Card type Command FF (Decoding Collection (Application) A1 (Track (Track (Track (Track length) (Track length) (Track length) 2A (Continued)
Section USB CARD DATA Card only to the the Report. The only If the from the when the to the to that nothing to swiped, the the The following shows the input structured. Item (Card type) Count (Track Count 6E (Track Count 6E (Track Count 6E (Command Count B2 Collection C0 Track Track Track Track Track Track Track Track Track Card type
USB TRACK DECODE STATUS This one-byte which the of there track the to If then occurred. If that and then indicated. If indicated, the the track that the to and supplied. TRACK DECODE STATUS This one-byte which the of track there this to If then occurred. If that and then indicated. If indicated, the track the track that the to and supplied. TRACK DECODE STATUS This one-byte which the of there this to If then occurred. If that and then indicated. If indicated, the the that the to and supplied. TRACK DATA LENGTH This of the field. This there the track or there the track. TRACK DATA LENGTH This of the field. This there the or there the track. TRACK DATA LENGTH This of the track field. This there the or there the track.
Section USB CARD ENCODE TYPE This the type of that found the The following the ISO/ABA ISO/ABA AAMVA AAMVA CADL CADL The Other The ISO/ABA The type occurred. This type the cleared or the This when this TRACK DATA If track, located the field that to the The of each field bytes, the of each field the that to the Track located that the track field and should The HID that reports the of Therefore, the the amount of that the and the of each indicated the track field. The and to ASCII. The includes with the and with the TRACK DATA This field the track TRACK DATA This field the track TRACK DATA This field the track
USB COMMANDS to commands to the to from the as previously this section. This section of the who to commands to the Command and to and from the Command to the using the HID The to command from the the HID These the the the of the Set_Report the completed. This that as as the Set_Report completed, the to the command The ID the shown previously the The following shows the command The following shows the command COMMAND NUMBER This field the of the The following the existing commands. Command DATA LENGTH This field the of the the field. DATA This that the of this field bytes. should the field offset the should to This field there The HID that Reports length. Command length. Therefore, the should with the Command GET_PROPERTY property the SET_PROPERTY property from the
Section USB RESULT CODE This the of the There of and command the to the commands and command. Command the to Command the that them. The commands. Command the the that them. the following GET AND SET PROPERTY COMMANDS The Property property from the The Property The Property property the The Property command The and Property command the and as follows: Property Property Property Property The the and Property commands of the the SUCCESS The completed successfully. FAILURE The command BAD_PARAMETER The to or Property ID Property Property ID Property
USB Property ID field that that the property. The following the property ID Property ID The Property field that the of the property. The of this field the type of property and the of the property. The following of the property and them. Property This The the property. This ASCII Its to that the property. The and of the include terminating NUL character. SOFTWARE_ID PROPERTY Property ID: Property Length: Property: Property: This only property that the software and the The first the and the the this might 21042804A02. follow: SOFTWARE_ID property (Hex): ID SOFTWARE_ID property (Hex): SOFTWARE_ID The software SERIAL_NUM The POLLING_INTERVAL The
Section USB SERIAL_NUM PROPERTY Property ID: Property Length: Property: Property: The with of The ASCII that the This This property EEPROM memory when the The of this property, to the when the the USB this property the to these the USB If other than the the factory follow. SERIAL_NUM property (Hex): ID SERIAL_NUM property (Hex): SERIAL_NUM property (Hex): ID SERIAL_NUM property (Hex): POLLING_INTERVAL PROPERTY Property ID: Property Length: Property: Property: The that the the The the of and of milliseconds. The the often to the the to the the This property to or the to to the host. The trade-off that the increases the USB the and slowing the the USB the This property EEPROM memory it when the The of this property,
USB to the when the the USB this property the to these the USB If other than the the factory follow: POLLING_INTERVAL property (Hex): ID POLLING_INTERVAL property (Hex): POLLING_INTERVAL property (Hex): ID POLLING_INTERVAL property (Hex): 0A 0A
SECTION DEMO PROGRAM The which written to the following: from the and the to the and the command their of to properly with the using the The the found this Section Accessories. INSTALLATION To the the and follow the instructions the OPERATION To the the following the USB the If this the first the the host, then follow the instructions the the HID This the section of this the To and the the Cards and when prompted to finished reading cards, the To commands to the the commands the should with each the followed the there The and the to the GET_PROPERTY property SOFTWARE_ID Press or to the and the The and the command displayed the The Clear clears the Communication
USB SOURCE CODE Source included with the It as It with to The USB Complete the chapter Interface Applications Reference Section
MAGTEK DEVICE DRIVERS FOR WINDOWS PROGRAMMING REFERENCE MANUAL NOVEMBER South Carson, CA FAX: Technical Support:
Information this to without of this or or or mechanical, without the written of Inc. of Inc. Microsoft, MS, MSDOS, MSCOMM and Microsoft of Microsoft Corporation; and of Microsoft Corporation. REVISIONS Notes Release c_wr_secure and and A: MT-85 and D: c_wr_secure and and and MT-85 Apr Changed of and MT-215 to readers; insertion to this section, A: Changed D. Changed Oct of commands, MICR and to write command; to updated A; Completely revised; D: applied_fmt to A: about Drivers" Notes to "Completing the Installation" about Edited "Removing the Drivers"; of NT D: and MSR, about MSR about ASCII and Character Conversion. throughout and Software MTD which includes ME/2000/XP. Copyright MAG-TEK, Inc. Printed the United States of America
Warranty Inc. warrants this IN ITS ENTIRETY, to of from the of purchase from Should this to this warranty its option, or this as forth below. and products furnished and or and products become the property of This warranty include service to to the from or of the Warranty service obtained the the warranty to S. Carson, CA If this to the or the of or to charges to the warranty service location and to the or ALL EXPRESS AND IMPLIED WARRANTIES FOR THIS PRODUCT, INCLUDING THE WARRANTIES OF MERCHANTABILITY AND FITNESS FOR PARTICULAR PURPOSE, ARE LIMITED IN DURATION TO PERIOD OF DAYS FROM THE DATE OF PURCHASE, AND NO WARRANTIES, WHETHER EXPRESS OR IMPLIED, WILL APPLY AFTER THIS PERIOD, EXCEPT AS PROVIDED IN THE PRECEDING SENTENCE. EACH PURCHASER UNDERSTANDS THAT THE MAG-TEK PRODUCT IS OFFERED AS IS. IF THIS PRODUCT IS NOT IN GOOD WORKING ORDER AS WARRANTED ABOVE, YOUR SOLE REMEDY SHALL BE REPAIR OR REPLACEMENT AS PROVIDED ABOVE. IN NO EVENT WILL MAG-TEK BE LIABLE TO YOU FOR ANY DAMAGES, INCLUDING ANY LOST PROFITS, LOST SAVINGS OR OTHER INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OF OR INABILITY TO USE SUCH PRODUCT, EVEN IF MAG-TEK HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES, OR FOR ANY CLAIM BY ANY OTHER PARTY. THIS WARRANTY GIVES YOU SPECIFIC LEGAL RIGHTS, AND YOU MAY ALSO HAVE OTHER RIGHTS WHICH VARY FROM STATE TO STATE.
SECTION OVERVIEW The (MTD) of that of products. These interface of The combined with of the when to The mount when faced with the of that of the MTD as follows: CD 9X/ME NT (MTD110-NT) 2000/XP (MTD110-2K-XP) PROBLEMS WITH CONTROLLING DEVICES The with that of as follows: of commands The commands of or their functionality. to to each supportedmuch DOS to to streams, This that from the character It would the responsibility to the incoming and from asynchronous that the from the arrives (or to the command The would to the of the collected or callback to and of to this, the with STX and ETX characters and others CR or the To with this, to and of the the
attached to the attached to to another or to the these greatly and would to the Additionally, meaningful with attached to the would This the operating to to the to the and BENEFITS OF CONTROL LANGUAGE AND DRIVER to of the functionality of noted previously, of functionality. The of commands that these the If the to covered the and to directly with the effectively the amount of the The based property/command This to who with and such as or You the and and commands. The interface to the though the operates asynchronously, greatly simplifying the from The to the and command, which the from the The which the the The the following easy to the as of they actually attached to the host. the and and correcting completely the The the that and assured that free from Converts the incoming The from the easy to The to received operation. to to The shields from the commands or interface. the
Section unchanged, though the from the The of that completely shield from the of functionality. LANGUAGE OVERVIEW The text based and to the and write I/O of the operating commands, their and of text that written to or from the using basic I/O. The based property/command that to the of and as such as or or command. read/write or only. with property and their the the following three These information about the of and only. They allow to to the Included this and These of operation or the commands of this, they usually and writable. They the to that of operation. Included this and These cover that the to the class. of first the or to D, to these affected with action That the action the when property or the property. The or commands to the to or the tracks.
COMMANDS commands and commands terminated feed <LF> or return. To command, writes to the the as writing to or If the the reads from the using the I/O as the write. of commands the Non-interactive These commands the without interaction with the The property commands and and of this type. Interactive These commands interact with the They the to anything the user to something. of such command. Others, such as or write however, user interaction to the or the to command. These commands to features. the that to to the host. These effectively commands. They allow the to the to operations that included the and With these commands, the amount of The commands exactly as specified the The command the and Three commands this type: and to and directly to the and that of the first of interactive and non-interactive commands that to the with these or commands should rarely
Section TYPICAL OPERATION This section typical that to Although the typical the to Section Applications, to to the applications. to the obtained the that the This the that the attached to, the COM5 or higher). the function and interactions with the the and, where required, the this the first to with the the or the the first (The the the If the the and This the or attempted. If the the the to the connected to the specified or its off, the seconds The should of this the The the to the The this the to the property to the the The or of the Its of operation and other features these the property to to written to or from to of this type of property the to the the The ready operation. with the interaction with the the operates the the interactive commands. typical when, to the prompted to using the command, to
the to the when swiped. the of the this of operation. the the finished with the the the obtained when The the required. with the closed properly. This the and further with that the rebooted. METHODS OF ACCESSING THE DEVICE This section to commands the (Microsoft Communication) to the If the (Microsoft Communication) ActiveX to the the CommPort property to the of the Then, the property to to The following shows the Comm.CommPort If Then If command, the seconds to with the this the appear to If I/O the option of the such as (where to that this and or its COM<5..15> The and to than however, the the of the The found the operating UI. and the On Next
Section This both the and the COM<5-15> It the physical that to with the the using of the whatever facility the following: The of the as found the operating UI with to the If the previous the it would the directoryclearly the Interacting with the interacts with the commands to the and reading its Commands writing to the and from the or property reading from the To interact with the the assigning to property. The OnComm as or directly the The to or property as If I/O access, interaction with the indistinguishable from writing to or reading from On Next the Access If Then If Comm_OnComm() If Then received Comm.Input non-read If
I/O interaction with the the received from the or the (as property This that the commands while The to this when the to the API, the the to I/O. Releasing to the Releasing to the If using MSComm, the its property to the FALSE If as as the following: the ERRORS AND ERROR PROCESSING commands to the commands The field located and of the to C. of property If while property, the with property when property the If indicating typically the following On Next input from If Then If
Section It the to the action and the command. This typical the that the ready or first other interaction the It the and the to the action. Typically, this action the or corrupted, otherwise functioning correctly. Finally, the refuse to operation of the should this the that the malfunctioning. HANDLING SPECIAL COMMANDS such as the PLUS of commands that and/or follow the The to these commands. It know to with and The allows the to to the used, the the command, characters, and character where the PLUS of commands that <SI> and <SO> as command instead of the and characters. These commands with the PLUS If the <SI>/<SO> commands the to the commands and the to of the the PLUS, the of the <SI>08[address]<SO>{LRC} The PLUS this commands the with and with To the the and the following to where <SI> and <SO> The whenever from the or when the of the other It to those that with the FILE PROPERTIES the performance characteristics, or reporting to the and of the associated to which and to the directory. Right the associated VXD A.
and Click the the and INSTALLATION The of the New Hardware facility 95/98/ME and the "INF" NT/2000/XP. to A. of the MICR Format to the built-in the the MICR to there the United States, where the information with these the the option of the the OEMSETUP.INF The to another to allow of the field following the (%CheckFormatCodeName%) the OEMSETUP.INF This three which to (MICR+, RS232, and that would the the to the and the chk_account, chk_amount, chk_number, and If to the the to the as from the MICR If the existing the MICR the %CheckFormatCodeName% to the to the MICR Technical Reference information about the of and MICR
SECTION PROPERTIES This section the that the interrogated and with command. to Section Commands and of commands. The the and the the the of the of reading three to only or MICR while often with MSR otherwise noted, the or the that the this the Access information whether the property (Read/Write R/W) or OnlyR). Property Access account_no R/W account including It the to PIN commands amount R/W Transaction amount without applied_fmt Indicates which template to the If template or applied, this property that the of PPINSERT) the reading of and PIN to command the MICR that the PPINSERT). c_keypress the of c_keystring the of of the cards. c_mechanics This the operates: manually operated or and and and the reading of c_smart the three-character the the The that the and to which
Property Access c_write the or HiCo; the the indicated c_wr_secure the the switch and wr_secure the operates the R/W this to to the from the the and write commands. The this property (PPINSERT). chk_account account from (MICR). chk_amount amount from (MICR). ID from the field (MICR). as from MICR (MICR). chk_format R/W Indicates the of the to If this property the the and to (MICR) from the field (MICR). chk_number (MICR). chk_routing Routing from the field (MICR). from the (MICR). chk_transit from (MICR). Command pendingindicates which command, If the <LF> R/W to to PIN such as when PIN; to when customers PIN connected and other If the to respond, reported: <LF> This directly from the the <CR> characters the from the with This property reporting to R/W this property to to CMC-7 characters to This international MICR information. (MICR)
Section Property Access R/W Encryption to the A-J R/W of Used to specify activating/deactivating PIN MSK and to the DUKPT The specified clear R/W or entry_echo R/W to the characters when from the the LCD to as to to as amount The of this property affects the operation of the command. this property empty. R/W of characters to collected with the command. this property to of entry_tout R/W Entry timeout: of seconds to input. R/W to to notifications. The (PPINSERT) R/W to to to commands This to R/W to to from the command to the this to This property the of the commands. each the to should R/W PIN (IBM (ANSI R/W to LCD with commands. the and commands the and commands the command the key_press and operations To leading the information.
Property Access offline_enc R/W to to with (MT-95). oper_tout R/W timeout seconds R/W PIN (ANSI or (IBM R/W PIN A..F) when Indicates the COM6) from the R/W off s_down_tout R/W Shutdown timeout hours to to track1ss track2ss track2ss R/W to PIN allow R/W reading and writing of tracks. The of this property of three characters, with representing and tracks, and and from and from and from and R/W Coercivity (MT-95). the to the selection wr_secure R/W the and write operation. this to to (MT- xact_type R/W type Indicates Track as received from the Indicates Track as from the Indicates Track as received from the authentication PIN collected (DUKPT only).
SECTION COMMANDS This section of the commands that with the commands to to the exactly what function to While there commands, commands with DATA FORMAT commands to the and of ASCII characters <LF> The <CR> as and with the character If command they should with or white The <SP> and <TAB> as white characters. immediately the previous as and the RESPONSES to the commands with to allow them to parsed white or offsets the the of the commands found this section, the with the shown their locations the of The fixed-field as shown the following command This field the command that this to the locations. Fixed-size the command property the field and location information right the field (with trailing the SS located and with or
NOTATION CONVENTIONS The following the that follow. Used to exactly as or from Used to optional. The of the <LF> ASCII character. The ASCII characters <LF> and <CR> Means that the or X(1|2) X1 or X2. The parentheses and the of the COMMAND DESCRIPTIONS The following of commands includes function, and as Function command. The optional of the commands such write If commands canceled. If the specified active, the and there The immediately. If issued the operation to aborted: Command <LF> <LF>
Section Commands Function or the The optional the to displayed. If the optional provided, this as If the to the to the If the the of the and the If empty, this displays the text otherwise, displays the and as The characters, which as characters: To the the LCD: You Command Function command. to characters (the of the field the without The echoing the command back. If the command that than characters or appears, the truncated. There commands. This with If to that the properly to Command Testing <LF> Testing <LF> to (shown as <CR> this to (shown as <LF> this to as LCD that converted to to character with ASCII Not ASCII displayed. Leading and trailing from the the and the and leading
Function to This when such as The of the the from the the type of that to the only the property and the property to the If already when the there when Consequently, recommended that issued immediately the to the If to when the PPINSERT: Command <LF> <LF> the Function property. of the shown Section or of those from <LF> Since The the If the property the field empty, <LF> follows the field. If the both the and empty. this the to the property interrogated (such as read) The this If to which the property: Command <LF> <LF> Indicating track
Section Commands Function the of the following clear encrypted encrypted encrypted the or 32-character of the to loaded. <LF> If the the length, or the there <LF> If the loaded. This to the With the the selected encrypted another the know the encrypted of the The to this SS SS rejected, To the encrypted the Command 99E1E835662DEA94 <LF> <LF>
Function from the <LF> If already 82<LF> If the the user with CLEAR This the of the that from the and to the as from the this that the switches to operation. The to this the following to C. of the the from the with the following characters replaced: <CR> <LF> other characters where the of the character. If that the to back the should the with or the /rawxact command. the characters the extracted the and to the To when the operating the Command <LF> <LF>
Section Commands Function to the which transmitted directly to the The as-is to the which as character: converted to <CR> to <LF> converted to to character with ASCII converted to This command as with the other commands that the of commands. the characters, and To the to to of the to\x1COur <LF> Command Function send/receive with the which transmitted directly to the The as-is to the which as character: to <CR> to <LF> to to character with ASCII to /rawxact <LF> If already <LF> If the the with CLEAR This of and It the to the the of the that from the and to the as the (or canceled), the switches to operation. The this to the of the command; the of the to the To of 23AB4589EF6701CD the Command /rawxact 9423AB4589EF6701CD <LF> <LF> /rawxact
Function from the The optional the read. to the below The optional to specify to displayed the LCD supported, carrying the command. If and the the text the property shown. to the the the of the <LF> If already or the <LF> If the the or the with CLEAR The to this the following The field 6-character to the right the field. It as follows: TX SS the type of that read: C PIN or from the to the type, such as (SS= this the of the as the MICR cards, XXX the each of the three the below of the PIN this and XXX the characters. SS other These the the and the or internal the and the SS field to to C. The the write command below. To amount to the the Command <LF> the amount <LF> K00300 <LF> To (from Command <LF> M10900 <LF>
Section The optional the the type of to and the text to displayed. The following the the command: type of This option to without the user the the following SS the track each of the three tracks, as follows: track track SS affected reported the field: canceled, the tracks. Read and PIN from This to the that the swiped, the collects and the PIN. The PIN collected the command. this command, the following to displayed while and PIN these The to this to the the from the If the SS the to the PIN. the reads the the following C SS XXX the of the as the MICR specification, character the field. SS read, canceled, This affected reported the XXX field. the which The the of the chk_format property.
chk_or_card or or swiped through the the the respective key_press the LCD and the to pressed. The entry_tout seconds the timeout). The to this XXXSS XXX the of collected. read, SS read, timeout, the ASCII of the SS the LCD and of from the The following this command: entry_tout of seconds to input timeout) timeout) to the characters from the the LCD to as to to as amount. Empty of characters to collected. this property as of the The to this the following XXXSS XXX the characters SS timeout input aborted, the collected from the
Section Commands Collect PIN from and PIN from the The following this command: account_no account including amount amount without (MSK only) to A-J xact_type (DUKPT only) type: C credit The P000 SS pin_block SS aborted, pin_block the encrypted PIN as the read, the following authentication (DUKPT only) of (DUKPT only)
Function the Clear operations and the to this the This of the To to its Command <LF> Function property. of the (R/W) shown Section the of that property. This to each of the that to command. To the the Command <LF> Function The to this the following text the text It parentheses, as shown this This the of the To the of the currently active Command <LF> <LF>
Section Commands write Function command. /write /write <LF> this /write <LF> The field the incorrect /write <LF> The write command canceled. /write <LF> already issued) /write <LF> write MT-95) The field the following (ASCII characters to to (ASCII characters to to The should the character If the track that lowercase characters (ASCII they To this and the as-is to the the property to The three sub-sections of the the three the The each with character, which both the and the the track: track (CA AAMVA) that or of the the of the the as write the that overwritten the operation. The this /write the succeeded and the of the C. and Command /write %B12345^TEST^0000?;12345? <LF> /write <LF>
This section the to the to from and those as which using the command. The that both and to the GOALS the MTD completely the commands and thereby allowing to the and to this the to the the when swiped. It to the to the This become the and each the type of ATM or The the easy to specify allow of allow with allow of and applying allow and the property to allow to from the registry to parsed to the command allow or to the (OEMSETUP.INF). ASSUMPTIONS The the template and the relation to the of the that field of and actually of the this. There field the field). account follow the account 12344556A). It the account A12344556). and specified the The terminating that follows property field included the as There of and/or SECTION MAGNETIC CARD DATA PARSING
Property specified characters or consisting of alphabetic characters, and The property with alphabetic character. with the If there property specified the the the of the parsed property rather than the of the following of Format One or characters specifying the of the to follow Used to of field which fixed-length field which and terminated Optional The fixed-size field or the field DESCRIPTION The MTD to consists of and of There template, there only template The the The template high-level to which the to as to the the should applied. The that specify to the and the which the parsed to the that knowledge to through property which with the command. The with the the software the registry. The following REG_SZ registry where _template template or the from the to match the incoming to of the If template matches, the to the using of the to the matched It to apply each the that appears the property. If the apply of the the to match the to the template and apply its or of
Section Card If the applying of the the of the the property applied_fmt. LANGUAGE FORMAT Format The which to the template and/or applied. The of this property characters. The repeated Format Template The template high-level to which the to apply the It characters and or parenthesis. The template characters. The following The template that the first characters following the of and the character or then the this template should applied. The to the character following the the template when the the other characters the template matched with the Format The property or that the to parsed. It of where each the following the and characters to each and specify optional tracks, these characters specified as within the
the to parsed. Characters that matched as as the or with the character of the following: or that to parsed or within The characters. The following the and account from {%B<acct_no>^<cust_name>^<*>?} The the and B ID the track. These characters matched the of the to executed. that to the following should property that to should property that the of the to should The following the specifying that property of characters. If there property specified than once the match the property. The matches and the to the previously consistency. field to the or property field the characters property field least characters and with characters to the field or property characters to the character specified the field or the character the bytes. with least characters and characters to the found.
Section Card the as and to should and to the of field. Non-ASCII Specify character or character. to <CR> converted to <LF> to to character with ASCII Optional choice The field choice where the or property field. There of specified there than property field, (=|<country_code[3]>). If the character otherwise the three characters property country_code. Optional optional that or the or property or optional choice Optional The that the track the when attempting to match the to the template or field or optional choice field containing of another optional field. There than specified The should curly and and with the template, to apply each the the the to first to apply If the incoming match the to apply If applied, the to match the incoming to the
The property the which the type of to that property. <cust_name:A> that should alphabetic characters, and punctuation. The with If type of characters assumed. The of the following Alphabetic characters (A..Z and allowed. characters characters. This the of and D. to character with ASCII this character allowed the field. This type character allowed supplied).
Section Card DEFAULT FORMATS The MTD assigned with The the INF the and written to the registry when the shown below; included with the these readability; they should included the "ISO59" fmt1_template"%B<*>^<*>^<*>?;59<*>=<*>?" fmt2_template"%A<*>^<*>^<*>?;<*>=<*>?" fmt3_template"%B<*>^<*>^<*>?;<*>=<*>?" "CADL" fmt4_template"%(C|S|D|I|R)<*>?;600646<*>?{(#|!)<*>?}" <Adr[29]><City[13]>? ;<*[6]><DLID[9]><*>=<ExpDate>=<DateOfBirth[8]>?
"AAMVA" "{%<State[2]><City>^<LastName>$<FirstName>$<MidName>^<Adr>^<*>? ;<*[6]><DLID>=<ExpDate[4]><DateOfBirth[8]><*>? {%<State[2]><City>^<LastName>$<FirstName>^<Adr>^<*>? ;<*[6]><DLID>=<ExpDate[4]><DateOfBirth[8]><*>? the CADL (California and AAMVA other the around the track that optional. EXAMPLE from this the the registry the The following from the %B1234567890074589^SMITH/JOHN Q.MR^9912101254700000000000123? Format (ISO59) the first of Format would there A following the the fits the template The following and their exposed: SMITH JOHN Q SMITH PAN The the M00900
Section Card The applied_fmt The with applied_fmt The to the The with JOHN. The to the The with SMITH. The PAN to the The with PAN The to the The with of the the them as the
SECTION EXAMPLE APPLICATIONS While each this section oriented each It the to to the with PROGRAMMING HINTS the to ALT-0 The should released. VISUAL BASIC EXAMPLE This of the It the and the to the At that the the and to the the of MICR) received, displays the and the to The first the to the that, the to initiate read. the read, the Read another The to the Option MTD written Copyright Inc. rights Source REV PROG REV This of the (MTD) It the and the to the At that it the the and to the the of MICR) received, the and the to The user first the to the that, the to initiate read. the read, the another The to the
The to "MSComm" should to and with the btnRead, should to and with "Read" should to and with text txtInfo, should to and containing text of "Click the to the shown its BASIC or The MUST preceded otherwise BASIC as the and This the to the the and the If Then If btnRead_Click This function the following: the the the the Reenable the btnRead_Click() the commands btnRead.Enabled Clear the the
Section Applications If the reading then the following to the If the type then the "/read" issued "/read" If the of reading than type and the of from of the then the issued or with the (They "/read" or the to the txtInfo.Text "Please or to the read. life, the other things while the the txtInfo.Text the btnRead.Enabled This function the following: the buttons and the its as its "COM12") the from the the (IMPORTANT: this or to the without the the its as the of the NewName$ to from the
the the from txtInfo.Text "Please the as IO" txtInfo.Refresh input If the unknown, obtained the with the and the COM The the as the property the the using the obtained Send/receive the when of release of the MTD the "MT-85" "MT-95" "MICR+" MICR RS-232" MICR RS-232" MICR (RS-232)" to the which that this and NewName$ Trap the found" the or ready On Next to the this anywhere from to Access If the to the then inform the
Section Applications If Then using the txtInfo.Text the On GoTo this If the On GoTo the to the the from which should the Expected (character the COM14" IMPORTANT: CLOSE THE DEVICE DRIVER BEFORE TRYING TO REOPEN IT back This that and that and COM and the right locations. If "COM") Then information, the txtInfo.Text IO the from character (and of the the as the on_comm function the the threshold to MSComm1.RThreshold
the from the MSComm1.CommPort the and establish with the the btnRead.Enabled txtInfo.Text "Click the to or to If then the correctly as IO of txtInfo.Text Got back: If Form_QueryUnload this closed the closed Form_QueryUnload(Cancel If Then If MSComm1_OnComm This activated whenever the to the MSComm1_OnComm() If this from the the then that this the If Then MSComm1.Input If
Section Applications C++ EXAMPLE The following of C++: TST: Application MTDTEST.C $Revision:: #include #include #include #include Static BOOL FALSE; HANDLE HANDLE in_threadh; HANDLE out_threadh; OVERLAPPED LPCTSTR to of the GENERIC_READ GENERIC_WRITE,/* DWORD (read-write) DWORD NULL, LPSECURITY_ATTRIBUTES to security OPEN_EXISTING, DWORD to FILE_FLAG_OVERLAPPED, DWORD NULL HANDLE template Function input_thread output_thread int int HANDLE DWORD DWORD int
clear sizeof sizeof OPEN_DEVICE ("COM5"); Specify COM# as OPEN_DEVICE INVALID_HANDLE_VALUE) printf("Can NOT %s. DCB GetCommState(drv_h, CBR_9600; dcb.Parity NOPARITY; dcb.StopBits ONESTOPBIT; dcb.fParity dcb.fBinary dcb.fOutxCtsFlow dcb.fOutxDsrFlow DTR_CONTROL_ENABLE; SetCommState(drv_h, printf("%s\n", STAGE (NULL, TRUE, FALSE, NULL), "Can't Event(read)" STAGE (NULL, TRUE, FALSE, NULL), "Can't Event(write)" STAGE CreateThread( NULL, of thread security 0L, thread (LPTHREAD_START_ROUTINE)output_thread,// of thread function NULL, thread 0L, creation immediately of thread "Can't thread" out_threadh STAGE CreateThread(
Section Applications NULL, of thread security 0L, thread (LPTHREAD_START_ROUTINE)input_thread,// of thread function NULL, thread 0L, creation immediately of thread "Can't input thread" in_threadh started. <^Z> to while switch WaitForSingleObject (in_threadh, INFINITE); TRUE; WaitForSingleObject out_threadh, WAIT_OBJECT_0) DWORD WaitForSingleObject out_threadh, INFINITE); out_threadh in_threadh SINGLE_CHARS input_thread int DWORD SINGLE_CHARS
switch TRUE; BOOL DWORD SINGLE_CHARS ERROR_IO_PENDING) of of count TRUE switch thread chance to catch character from there should to this BUFSZ output_thread BOOL
Section Applications DWORD while sizeof(wbuff), ERROR_IO_PENDING) printf("DeviceIOControl (Read) WaitForSingleObject INFINITE); of or of of count FALSE while TRUE; putch of
POWER BUILDER EXAMPLE The following to (from to from the interface to easily, third-party OCX required. The first of this shows to ActiveX The shows to interface with the OCX, the MTD and the this the The following ActiveX with Product IO ActiveX Software members.aol.com/easyio N/A COMM-DRV/LIB WCSC chosen IO ActiveX from Software Island. that to this From the OLE. From the New the OCX, IO (It that the OCX already to the Then OK. anywhere the and the Right the and Properties. the text field. MTD OCX the and Click OK. Right anywhere the the then the Title: field. the check-off the shown then OK. Right anywhere the the then the option. the following the to OCX This the the invisible that the OLE COM5 the which assigned to RS-232 installation. It installation. then END
Section Applications the and to the and to At the then OK. the PowerScript the and the following commands the (This the to The to the pushed.) Application to of OLE ActiveX to interface to (MTD). ActiveX to the This seconds while the Include commands Specify the of seconds to to ole_io.mtd.object.SetTimeOut(120) the to shown the to The of commands. ole_io.mtd.object.WriteString("/set NextCard: the to read. ole_io.mtd.object.WriteString("/read the to swiped. ole_io.mtd.object.ReadString(250) the read. then PIN processing from ole_io.mtd.object.WriteString("/display Thank the MessageBox("Read It timeout from the OCX. the active command the ole_io.mtd.object.WriteString("/cancel the to ole_io.mtd.object.ReadString(50) then NextCard
APPENDIX A. INSTALLATION AND SETUP The the MTD of the products. to the there of that to the and of these The the below. of the of the associated the (IPIN.VXD) interface vehicle three interface to the interface type installation. the option of the and the to (physical The the which the The to the that the physically attached to the PC.
INSTALLING DEVICE DRIVERS (W95/98/ME) or Directory DESCRIPTION OEMSETUP.INF README.TXT the and \W95_DRV Directory The following 95/98/ME located this directory: Advanced DMAPLD.VXD DMVXD.VXD DMVXDD.VXD DriverMagic GENERIC.VXD that allows with RS-232 IPIN.VXD MICR DLL the MAGCDFLT.DLL MAGCDFLT.HLP Class MAG-TEKCL.DLL MAG-TEKCL.VXD Class MAGWEDGE.VXD interface) MICR+ MICRPLUS.VXD MICR (RS-232 interface) MICR RS-232 MINIMICR.VXD MICR (RS-232 and MICR interfaces) MINIWEDG.VXD interface) MT-85 MT85.VXD MT-85 (RS-232 interface) MT-95 MT95.VXD MT-95 (RS-232 interface) (RS-232 MTPPINSR.VXD interface) MTPPSWIP.VXD (RS-232 interface) If when or it to the Removing the (W95/98/ME) section this instructions to the (RS-232, and MICR+ interfaces)
A. and Notes: The and should off when connecting Although to the connected to the highly recommended. This allows the and to tested when the which each the as this information the installation process. of location with the and "the specified location information about To that the the directory that its path. the First (W95/98/ME) the and the New Hardware Click the Next to to the first input 98/ME, to Next Select the when to search and the Next Select Other from the then the Next button. (If included the types" to Another (W95/98/ME) Click the the the CD and the or to to where the (oemsetup.inf) located; the OK the Select the to from the of and the Next button. Click the The to the Please NOT the If the displays Change and that the please with Completing the (W95/98/ME) below. Another (W95/98/ME) If least already follow these the and the New Hardware Click the Next to to the first input 98/ME, to Next Select the when to search and the Next
from the of then the Next Select the to from the and the Next Click the The to the Please If the found, and to where the (oemsetup.inf) located; the OK the If the displays stating and that the please with Completing the (W95/98/ME) below. (W95/98/ME) of these to Right-click the or the and the then Click the Click the front of the item to the to updated or once the then the Click the Click the Select the when to search and the Next from the shown, then the Next Select the to from the displayed and the Next button. Click the The to the Please If the displays and that the please with Completing the (W95/98/ME) below. Completing the (W95/98/ME) The New the selected If this the first the the the completed, the property sheet displayed (the title the following to the
A. and Either the selection the or the (COM5-COM15) to associated with the from the and the the Select the to which the connected Notes (W95/98/ME) from the to Click the to the and the (The function only COM through The COM11-15 the from Click OK to the If the displays stating The specified To another the To" correct. If only selected), the OK to the the to the (W95/98/ME) To the the following Right-click the or the and the then A-1. Select the the clicking the the the then Select the to the the and to the physical Click the Advanced A-2) to the MICR+) which allow the to the of the If required, the Specify manually and the Click OK when
A-1. 95/98/ME A-2. 95/98/ME
A. and the (W95/98/ME) The following familiarity with the of the to to function. Please follow the instructions Complete of the the from the using the and the manually the To the follow these that using the This that of the that to closed. Right-click the or the and the then Select the and the Select the the and Then OK this to or other the following from GENERIC.VXD IPIN.VXD MAGWEDGE.VXD MICRPLUS.VXD MINIMICR.VXD MINIWEDG.VXD MT85.VXD MT95.VXD MTPPINSR.VXD MTPPSWIP.VXD The only currently that them. the (MAG-TEKCL.VXD) type The when of that type the from The DMAPLD.VXD DMVXD.VXD DMVXDD.VXD MAG-TEKCL.DLL MAG-TEKCL.VXD MAGCDFLT.HLP
MAGCDFLT.DLL and the of the release of located C:\Windows\inf\ With the OSR2 release of and 98/ME, the located C:\Windows\inf\other\ the clicking then REGEDIT the text and the the following from the registry: HKEY_LOCAL_MACHINE\Software\Mag-Tek\ClassMap and HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Class\Mag-Tek. the following from the registry: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\InstalledFiles\ DMAPLD.VXD DMVXD.VXD DMVXDD.VXD IPIN.VXD MAGCDFLT.DLS MAGCDFLT.HLP MAG-TEKCL.DLS MAG-TEKCL.VXD MAGWEDGE.VXD MICRPLUS.VXD MINIMICR.VXD MINIWEDG.VXD MT85.VXD MT95.VXD MTPPINSR.VXD MTPPSWIP.VXD 98/ME, the following from the registry: HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Setup\SetupX\Inf\OEMName\ %windir%\inf\other\MAGTE~1.INF %windir%\inf\other\MAG-TEKOEMSETUP.INF HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Installed MAGCDFLT.DLS MAG-TEKCL.DLS HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\SessionManager\Known16DLLs\ MAG-TEKCL.DLL the selecting
A. and INSTALLING DEVICE DRIVERS (WNT) or Directory DESCRIPTION OEMSETUP.INF README.TXT the and procedures \WNT_DRV Directory The following NT located this directory: DriverMagic Advanced DMAPLD.DLL DMNTK.DLL DriverMagic DMNTKD.DLL DriverMagic that allows GENERIC.SYS with using command RS-232 IPIN.SYS MICR MAG-TEKCL.SYS Class interface) MAGWEDGE.SYS MICR+ MICR (RS-232 interface) MICRPLUS.SYS MICR RS-232 MINIMICR.SYS MICR (RS-232 and MICR interfaces) interface) MINIWEDG.SYS MT-85 MT85.SYS MT-85 (RS-232 interface) MT-95 MT95.SYS MT-95 (RS-232 interface) MTCFG.EXE Command-line MTD_KBH.SYS MTPPINSR.SYS (RS-232 interface) (RS-232 MTPPSWIP.SYS interface) NT, users with as (or as with to the MTD It to the of MTD and re-boot the this of the The MTD from to The the NT (RS-232, and MICR+ interfaces)
the clicking the the On the and the that reads MTD release or (MTD) then the Re-boot the the the (WNT) To the (*.SYS), follow these the and the Select the OEMSETUP.INF and the from NT the successfully. If there shown. If located, the to the to the MTD If, the or other or repeating the operation. Uninstalling the (WNT) that the MTD to to this the to that the re-booted to the The using the NT the double-clicking the the On the and the that reads (MTD) then the button. to this operation. The MTD and the registry as The re-booted to the from memory. the re-booted the
A. and INSTALLING DEVICE DRIVERS (W2000/XP) or Directory DESCRIPTION MTD_KBH.INF MTD_KBH.SYS OEMSETUP.INF the and README.TXT \I386 Directory Microsoft \W2K_DRV Directory The following 2000/XP located this directory: DriverMagic DMNTK.DLL DMNTKD.DLL DriverMagic GENERIC.SYS that allows with RS-232 IPIN.SYS MICR MAGTEKCL.SYS Class MAGWEDGE.SYS interface) MICR+ MICR (RS-232 interface) MICRPLUS.SYS MICR RS-232 MINIMICR.SYS MICR (RS-232 and MICR interfaces) interface) MINIWEDG.SYS MT-85 MT85.SYS MT-85 (RS-232 interface) MT-95 MT95.SYS MT-95 (RS-232 interface) MTCFG.EXE Command-line MTPPINSR.SYS (RS-232 interface) MTPPSWIP.SYS (RS-232 interface) (RS-232, and MICR+ interfaces)
2000/XP, only users with as (or as with to the MTD It to the previous of MTD and re-boot the this of the The MTD from to The using the 2000/XP the clicking the the On the Install/Uninstall and the that reads MTD release or (MTD) then the Re-boot the the the (W2000/XP) To the follow these the and the using Select the OEMSETUP.INF and the from 2000/XP the successfully. the and the Click the "Hardware" Click the Click the to the "Keyboards" the Right the "PC/AT Enhanced PS/2 entry. Click the item the Click the Click the Click the Next to to the first input Select the of the known Click the Next to to the input Click the and directory the "Copy from:" text Click the Next to to the input Click to the Warning".
A. and Click the Next to to the input Click to the Not Found". Click Click the to the If, the installation, or other or repeating the operation. Uninstalling the (W2000/XP) that the MTD to to this the to that the re-booted to the The the the double-clicking the the On the and the that reads (MTD) then the button. to this operation. The MTD and the registry as required. Uninstalling the (W2000/XP) 2000/XP, the the (cf. and the and the Click the "Hardware" Click the button. Click the to the "Keyboards" the Right the "PC/AT Enhanced PS/2 Click the item the Click the Click the button. Click the Next to to the first input Select the "Search Click the Next to to the input
Optional search locations boxes. Click the Next to to the input Click the Next to to the input to the "Confirm This This should seconds and 2000/XP should recover without or Click Click the to the WINDOWS NT/2000/XP CONFIGURATION UTILITY To or the MTCFG.EXE It the The below typical of and of the MTCFG.EXE utility, the MTCFG (WNT/2000/XP)" below. with the installation, this phase the to to physically connected the when The only the when The consists of phases: the and re-boot with MTCFG. (WNT/2000/XP) The the following Select COM the Choose and that other the displays COM currently used). the following the DOS (the COM5 selected): COM5 The third optional and around they include If the successfully, MTCFG the following Re-starting MTD MTD. Press to MTD Press the to the MTD the operation the displays:
A. and MTD re-started. The (WNT/2000/XP) MICR the following Select COM the Choose and that other the it currently used). MTCFG that the COM selected another Select to which the attached used; the of existing MTCFG allows to as attached to the portin this these the following the NT command (the that the physically connected to COM2 and MTD appear as COM6): COM6 MICR RS-232" UsePort=COM2 MICR RS-232" The specified COM2 or The fourth optional and If the successfully, MTCFG the following Press the to the MTD the operation the displays: MTD re-started. The MICR (WNT/2000/XP) the that the MICR+ and If the the MICR+ properly to with to its thereby the from Additionally, that the both both the MICR+ and the the MICR+ the and closed the closed. The MICR to the The only that the UsePort AUX followed the or of the to which the attached. (The that the physically connected to of MICR+ Re-starting MTD MTD. Press to MTD
and MTD appear as COM7. The MICR+ appears to the as COM12 and MICR+.) shown: COM7 MICR MICR+" AUX" or COM7 MICR COM12" AUX" the of Devices (WNT/2000/XP) MTCFG with If the used, the displayed to COM5 COM6 COM1 MICR RS-232 MICR RS-232 COM7 AUX MICR+ MICR AUX the MTCFG (WNT/2000/XP) MTCFG.EXE command-line with the MTD It that the correctly as the MTCFG to the from the the the following correctly Please the using this The the manually, the or or the It recommended that that terminated MTCFG to or to or
A. and Command summary Command of and these commands MTCFG the Information (WNT/2000/XP) To the of the following To the COM COM the of the as when the first This shown the the of This displays the the the that to To including the following COM The and the information New Devices (WNT/2000/XP) To the following or the chosen the It another the or other). The the COM COM5 COM255). MTCFG that the other that with this whether the other the
the of the to The should to of The MTCFG the specified the section of the MTD (OEMSETUP.INF). or the The these to the when the of already the section of Specifying when optional they specified the section), recommended to include least those that the to
A. and NT/2000/XP These only. of the to to the or Command RS-232 MTCFG COM5 (RS- UsePort=COM1 parity=0 KB MTCFG COM6 RS-232 MTCFG COM7 MICR "UsePort=AUX MICR+" RS-232 MTCFG COM8 RS-232" UsePort=COM2 KB MTCFG COM9 KB" to allow the MTCFG COM10 MICR+ MTCFG COM11 "MICR+" Communication UsePort=COM1 required. MICR RS-232 MTCFG COM12 MICR RS-232" UsePort=COM1 required. MICR KB MTCFG COM13 MICR MTCFG COM14 MT-85 MTCFG COM15 "MT-85" UsePort=COM2 MT-95 MTCFG COM16 "MT-95" UsePort=COM1 parity=-1 MTCFG COM17 UsePort=COM1 MTCFG COM18 UsePort=COM2 to specify the the selected "UsePort" The MICR+ this Communication required. Communication Communication required. required.
(WNT/2000/XP) the following to of each of the specified as the whole should the to the MT-85 COM1 as the COM5 with of the following COM5 COM1 Following of that and when the of MTCFG COM5). (optional, only) specified as (optional, only) specifying the the or and respectively. (optional, only) specifies the or (optional, only) to or the to which the connected. (or that with (optional) the If specified, the from user this (the to the FriendlyName=Port-powered this as (optional) this to to and to to the which the to applications. this the to to this when the MTCFG COM5 executed, the that COM5, to as COM8 invocations of MTCFG. This treated specially MTCFG the and that other the change. other than the should without the the
A. and (WNT/2000/XP) To the following The and specified This from the To and the MTD follow the instructions the section. MTD PROGRAMMING EXAMPLES included the following directory: or Directory DESCRIPTION \EXAMPLES\CPP C++ and \EXAMPLES\DELPHI MSCOMM and I/O based and MSCOMM and I/O based \EXAMPLES\VB50 and the
APPENDIX B. COMMAND LIST SUMMARY This of commands the Command command. of the commands. or the LCD command. to property. the from the to the send/receive with the from the Clear operations and the to property. Read /write command.
APPENDIX C. STATUS CODES The following the command that as of as necessary. and already ID 1F whatever of text or internal Unexpected from API rejected operation or I/O (peripheral item found item allowed type ID time-out operation aborted or implemented or
APPENDIX D. DEVICE DRIVER SUMMARIES This section of the the following and PLUS MICR+ RS-232 RS-232 Insertion MT-85 MT-95 The summary each of the commands supported.
INTELLIPIN PINPAD MSR IPIN.VXD Name(s) RS-232, MICR+ The the supported; the specified manually. the the MICR+ the MICR+ the the closed the MICR+ closed. Commands Supported Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout chk_transit c_keypress c_keystring s_down_tout track1ss c_mechanics track2ss enc_key_sn track3ss c_smart trivpinchk entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the /write
D. MAGWEDGE SWIPE READER MAGWEDGE.VXD Name(s) The which the the and Commands Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss enc_key_sn track3ss c_smart trivpinchk entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the /rawxact /write
MINIWEDGE MSR MINIWEDG.VXD Name(s) operating the the as ASCII characters instead of to reduce the (A 3-track about whereas the seconds.) If this the and the registry and/or INF The this to too fast, try this to Additionally, the to to Commands Supported Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss track3ss c_smart entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the /write
D. MICR+ CHECK READER MSR MICRPLUS.VXD Name(s) MICR+ These or MSR If the properly the Commands Supported Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout chk_transit c_keypress c_keystring s_down_tout track1ss c_mechanics track2ss track3ss c_smart entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the INF Section "MICR Format information. /rawxact /write
MINI MICR CHECK READER MSR MINIMICR.VXD Name(s) MICR RS-232 MICR These or MSR If the properly the Commands Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss track3ss c_smart trivpinchk c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the INF Section "MICR Format information. /write
D. PORT-POWERED RS-232 SWIPE READER MTPPSWIP.VXD Name(s) This readers. Commands Supported Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss track3ss c_smart entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the /write
PORT-POWERED RS-232 INSERTION READER MTPPINSR.VXD Name(s) If the when the It that the to the from included the of If already when the there when Consequently, recommended that issued immediately the to the Supported Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss track3ss c_smart trivpinchk entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the /write
D. MT-85 LOCO ENCODER MT-85 Name(s) The to to the Commands Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss track3ss c_smart entry_echo c_write c_wr_secure entry_tout chk_acount chk_amount wr_secure chk_format xact_type the MT85.VXD /write
MT-95 HICO ENCODER MT95.VXD Name(s) MT-95 Commands Supported Property Property Property account_no amount chk_number applied_fmt chk_routing offline_enc oper_tout c_keypress s_down_tout track1ss c_mechanics track2ss track3ss c_smart trivpinchk entry_echo c_write c_wr_secure entry_tout chk_account chk_amount wr_secure chk_format xact_type the /rawxact /write